{"version":3,"file":"3.DT7EyDwg.js","sources":["../../../../../../src/routes/admin/+page.js","../../../../../../src/routes/admin/ImageUploadTest.svelte","../../../../../../src/routes/admin/+page.svelte"],"sourcesContent":["export const ssr = false;\n","<script>\n  import { uploadImage, getImageUrl, listSuspectImages, deleteImage } from '$lib/storage';\n  import { suspects } from '$lib/data/suspects';\n  \n  let selectedFile;\n  let selectedSuspect = suspects[0];\n  let uploadStatus = '';\n  let imageList = [];\n  let uploadedImageUrl = '';\n\n  async function handleFileSelect(event) {\n    selectedFile = event.target.files[0];\n  }\n\n  async function handleUpload() {\n    try {\n      uploadStatus = 'Uploading...';\n      const fileExt = selectedFile.name.split('.').pop().toLowerCase();\n      const fileName = `profile.${fileExt}`; // Always use profile.jpg or profile.jpeg\n      \n      // Delete existing profile images first\n      const existingImages = await listSuspectImages(selectedSuspect.id);\n      for (const file of existingImages) {\n        if (file.name.startsWith('profile.')) {\n          await deleteImage(`${selectedSuspect.id}/${file.name}`);\n        }\n      }\n      \n      await uploadImage(selectedFile, selectedSuspect.id, fileName);\n      uploadStatus = 'Upload successful!';\n      \n      // Get the URL of the uploaded image\n      const path = `${selectedSuspect.id}/${fileName}`;\n      uploadedImageUrl = await getImageUrl(path);\n      \n      // Refresh the image list\n      await loadImages();\n    } catch (error) {\n      uploadStatus = `Upload failed: ${error.message}`;\n      console.error('Upload error:', error);\n    }\n  }\n\n  async function loadImages() {\n    try {\n      imageList = await listSuspectImages(selectedSuspect.id);\n    } catch (error) {\n      console.error('Failed to load images:', error);\n    }\n  }\n\n  async function handleDelete(fileName) {\n    try {\n      const path = `${selectedSuspect.id}/${fileName}`;\n      await deleteImage(path);\n      await loadImages();\n    } catch (error) {\n      console.error('Delete failed:', error);\n    }\n  }\n\n  $: if (selectedSuspect) {\n    loadImages();\n  }\n</script>\n\n<div class=\"p-4\">\n  <h2 class=\"text-xl font-bold mb-4\">Image Upload Test</h2>\n  \n  <div class=\"mb-4\">\n    <select \n      bind:value={selectedSuspect}\n      class=\"border p-2 rounded\">\n      {#each suspects as suspect}\n        <option value={suspect}>{suspect.name}</option>\n      {/each}\n    </select>\n  </div>\n\n  <div class=\"mb-4\">\n    <input \n      type=\"file\" \n      accept=\"image/jpeg\"\n      on:change={handleFileSelect}\n      class=\"mb-2\">\n    \n    <button \n      on:click={handleUpload}\n      disabled={!selectedFile}\n      class=\"bg-blue-500 text-white px-4 py-2 rounded disabled:opacity-50\">\n      Upload\n    </button>\n  </div>\n\n  {#if uploadStatus}\n    <p class=\"mb-4\">{uploadStatus}</p>\n  {/if}\n\n  {#if uploadedImageUrl}\n    <div class=\"mb-4\">\n      <h3 class=\"font-bold\">Last Uploaded Image:</h3>\n      <img src={uploadedImageUrl} alt=\"Uploaded\" class=\"max-w-xs mt-2\">\n    </div>\n  {/if}\n\n  <div>\n    <h3 class=\"font-bold mb-2\">Existing Images:</h3>\n    <div class=\"grid grid-cols-3 gap-4\">\n      {#each imageList as file}\n        <div class=\"border p-2\">\n          <p class=\"text-sm mb-2\">{file.name}</p>\n          <button\n            on:click={() => handleDelete(file.name)}\n            class=\"bg-red-500 text-white px-2 py-1 rounded text-sm\">\n            Delete\n          </button>\n        </div>\n      {/each}\n    </div>\n  </div>\n</div>\n","<script>\n  import EvidenceBoard from '$lib/components/EvidenceBoard.svelte';\n  import ImageUploadTest from './ImageUploadTest.svelte';\n</script>\n\n<div class=\"admin-container p-4\">\n  <h1 class=\"text-3xl mb-8 burton-text-shadow\">Admin Dashboard</h1>\n  \n  <div class=\"grid gap-8\">\n    <EvidenceBoard />\n    <ImageUploadTest />\n  </div>\n</div>\n"],"names":["ssr","t_value","ctx","insert_hydration","target","option","anchor","p","attr","img","img_src_value","div","append_hydration","h3","t0_value","button","dirty","set_data","t0","suspects","i","create_if_block_1","create_if_block","add_render_callback","select","div4","h2","div0","div1","input","div3","div2","selectedFile","selectedSuspect","uploadStatus","imageList","uploadedImageUrl","handleFileSelect","event","$$invalidate","handleUpload","fileName","existingImages","listSuspectImages","file","deleteImage","uploadImage","path","getImageUrl","loadImages","error","handleDelete","select_value","h1"],"mappings":"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"}
