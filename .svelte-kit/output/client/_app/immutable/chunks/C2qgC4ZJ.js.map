{"version":3,"file":"C2qgC4ZJ.js","sources":["../../../../../../src/lib/stores/gameState.js","../../../../../../src/lib/actions/interactable.js","../../../../../../src/lib/components/EvidenceBoard.svelte"],"sourcesContent":["import { writable, derived, get } from 'svelte/store';\nimport { browser } from '$app/environment';\nimport { supabase } from '$lib/supabase';\n\n// Initialize with empty defaults for SSR\nexport const inventory = writable([]);\nexport const activeClues = writable([]);\nexport const currentScene = writable('entrance');\nexport const dialogueState = writable(null);\nexport const gameFlags = writable({});\nexport const playerState = writable({\n  position: { x: 0, y: 0 },\n  hasFlashlight: false,\n  currentRoom: 'entrance'\n});\n\n// Initialize data only on client side\nif (browser) {\n  activeClues.set([\n    {\n      id: 1,\n      title: \"Mysterious Note\",\n      description: \"Found in the study. Handwriting appears shaky.\",\n      type: \"note\",\n      color: \"#ffd700\"\n    },\n    {\n      id: 2,\n      title: \"Broken Watch\",\n      description: \"Stopped at exactly 10:47 PM. Found near the body.\",\n      type: \"evidence\",\n      color: \"#ff9999\",\n      connections: [1, 3]\n    },\n    {\n      id: 3,\n      title: \"Strange Symbol\",\n      description: \"Carved into the mansion's front door. Matches victim's pendant.\",\n      type: \"clue\",\n      color: \"#98fb98\",\n      connections: [2]\n    }\n  ]);\n}\n\nexport const saveGameState = async () => {\n  if (!browser) return false;\n  \n  const { data, error } = await supabase\n    .from('game_states')\n    .upsert({\n      inventory: get(inventory),\n      active_clues: get(activeClues),\n      current_scene: get(currentScene),\n      game_flags: get(gameFlags)\n    });\n  \n  if (error) console.error('Save error:', error);\n  return !error;\n};\n","export function interactable(node, options = {}) {\n  let isHovered = false;\n  \n  function handleMouseEnter() {\n    isHovered = true;\n    node.style.cursor = 'pointer';\n    if (options.highlight) {\n      node.style.filter = 'brightness(1.2)';\n    }\n  }\n  \n  function handleMouseLeave() {\n    isHovered = false;\n    node.style.cursor = 'default';\n    if (options.highlight) {\n      node.style.filter = 'none';\n    }\n  }\n  \n  function handleClick(event) {\n    if (options.onClick) {\n      options.onClick(event);\n    }\n  }\n  \n  node.addEventListener('mouseenter', handleMouseEnter);\n  node.addEventListener('mouseleave', handleMouseLeave);\n  node.addEventListener('click', handleClick);\n  \n  return {\n    destroy() {\n      node.removeEventListener('mouseenter', handleMouseEnter);\n      node.removeEventListener('mouseleave', handleMouseLeave);\n      node.removeEventListener('click', handleClick);\n    }\n  };\n}\n","<script>\n  import { activeClues } from '$lib/stores/gameState';\n  import { onMount } from 'svelte';\n  import { interactable } from '$lib/actions/interactable';\n  \n  function getRandomPosition() {\n    return {\n      top: `${Math.random() * 60 + 20}%`,\n      left: `${Math.random() * 60 + 20}%`,\n      transform: `rotate(${Math.random() * 10 - 5}deg)`,\n      '--random': Math.random()\n    };\n  }\n\n  let boardElement;\n  let canvas;\n  let ctx;\n  \n  function handleClueClick(clue) {\n    console.log('Clue clicked:', clue);\n    // Add your click handling logic here\n  }\n  \n  onMount(() => {\n    if (!boardElement) return;\n    \n    canvas = document.createElement('canvas');\n    canvas.style.position = 'absolute';\n    canvas.style.inset = '0';\n    canvas.style.pointerEvents = 'none';\n    canvas.style.zIndex = '1';\n    \n    ctx = canvas.getContext('2d');\n    boardElement.appendChild(canvas);\n    \n    const updateCanvas = () => {\n      const rect = boardElement.getBoundingClientRect();\n      canvas.width = rect.width;\n      canvas.height = rect.height;\n      \n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.strokeStyle = '#ff000055';\n      ctx.lineWidth = 2;\n      \n      $activeClues.forEach(clue => {\n        if (clue.connections) {\n          const sourceEl = document.getElementById(`clue-${clue.id}`);\n          clue.connections.forEach(targetId => {\n            const targetEl = document.getElementById(`clue-${targetId}`);\n            if (sourceEl && targetEl) {\n              const sourceRect = sourceEl.getBoundingClientRect();\n              const targetRect = targetEl.getBoundingClientRect();\n              \n              ctx.beginPath();\n              ctx.moveTo(\n                sourceRect.left - rect.left + sourceRect.width / 2,\n                sourceRect.top - rect.top + sourceRect.height / 2\n              );\n              ctx.lineTo(\n                targetRect.left - rect.left + targetRect.width / 2,\n                targetRect.top - rect.top + targetRect.height / 2\n              );\n              ctx.stroke();\n            }\n          });\n        }\n      });\n    };\n\n    updateCanvas();\n    window.addEventListener('resize', updateCanvas);\n\n    return () => {\n      window.removeEventListener('resize', updateCanvas);\n    };\n  });\n</script>\n\n<div class=\"evidence-board\" bind:this={boardElement}>\n  <div class=\"cork-texture\"></div>\n  <div class=\"board-title\">Evidence Board</div>\n  \n  {#if $activeClues.length === 0}\n    <div class=\"empty-state\">\n      No evidence collected yet...\n    </div>\n  {/if}\n  \n  {#each $activeClues as clue}\n    <div \n      id=\"clue-{clue.id}\"\n      class=\"evidence-note\"\n      use:interactable={{\n        highlight: true,\n        onClick: () => handleClueClick(clue)\n      }}\n      style={Object.entries(getRandomPosition())\n        .map(([k, v]) => `${k}: ${v}`).join(';') + `;background-color: ${clue.color || '#fff9e6'};`}\n    >\n      <div class=\"pin\"></div>\n      <h3 class=\"text-lg font-bold text-burton-charcoal\">{clue.title}</h3>\n      <p class=\"text-sm mt-2\">{clue.description}</p>\n      {#if clue.image}\n        <img src={clue.image} alt=\"\" class=\"mt-2 w-full rounded\">\n      {/if}\n    </div>\n  {/each}\n</div>\n\n<style>\n  .evidence-board {\n    @apply w-[80vw] h-[70vh] relative mx-auto my-8 overflow-hidden;\n    background: #8B4513;\n    border: 12px solid #4a2511;\n    box-shadow: \n      inset 0 0 20px rgba(0,0,0,0.5),\n      0 0 30px rgba(0,0,0,0.3);\n  }\n\n  .board-title {\n    @apply absolute top-4 left-1/2 -translate-x-1/2 text-3xl font-bold;\n    color: #4a2511;\n    text-shadow: 1px 1px 0 #96613d;\n    letter-spacing: 2px;\n  }\n\n  .empty-state {\n    @apply absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2;\n    @apply text-2xl text-[#4a2511] opacity-70 font-bold italic;\n  }\n\n  .cork-texture {\n    @apply absolute inset-0;\n    background-image: \n      radial-gradient(#96613d 15%, transparent 16%),\n      radial-gradient(#96613d 15%, transparent 16%);\n    background-size: 10px 10px;\n    background-position: 0 0, 5px 5px;\n    opacity: 0.5;\n  }\n\n  .evidence-note {\n    @apply absolute p-4 rounded-sm;\n    box-shadow: \n      2px 2px 5px rgba(0,0,0,0.2),\n      0 0 0 1px rgba(0,0,0,0.05);\n    max-width: 250px;\n    transition: all 0.3s ease;\n  }\n\n  .evidence-note:hover {\n    transform: scale(1.05) rotate(0deg) !important;\n    z-index: 10;\n    box-shadow: \n      5px 5px 10px rgba(0,0,0,0.3),\n      0 0 0 1px rgba(0,0,0,0.1);\n  }\n\n  .pin {\n    @apply absolute w-4 h-4 rounded-full;\n    background: radial-gradient(circle at 30% 30%, #ff4444, #cc0000);\n    box-shadow: 0 1px 2px rgba(0,0,0,0.3);\n    top: -8px;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n\n  .pin::after {\n    content: '';\n    @apply absolute w-2 h-2 rounded-full;\n    background: rgba(255,255,255,0.5);\n    top: 20%;\n    left: 20%;\n  }\n</style>\n"],"names":["inventory","writable","activeClues","interactable","node","options","handleMouseEnter","handleMouseLeave","handleClick","event","insert_hydration","target","div","anchor","src_url_equal","img","img_src_value","ctx","attr","dirty","t1_value","t3_value","if_block","create_if_block","div1","div1_id_value","div1_style_value","getRandomPosition","func","append_hydration","div0","h3","p","interactable_function","set_data","t1","t3","create_if_block_1","i","div2","handleClueClick","clue","k","v","boardElement","canvas","onMount","updateCanvas","rect","$activeClues","sourceEl","targetId","targetEl","sourceRect","targetRect","$$value"],"mappings":"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"}
